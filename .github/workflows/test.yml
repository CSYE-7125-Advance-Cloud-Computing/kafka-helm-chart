name: Helm Chart Tests

on:
    pull_request:
      branches: [main]

jobs:
  lint_and_template:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Set up Helm
        uses: azure/setup-helm@v1

      - name: Initialize helm
        run: helm repo add stable https://charts.helm.sh/stable
      
      - name: update helm
        run: helm repo update

      - name: Add Bitnami dependencies
        run: helm repo add bitnami https://charts.bitnami.com/bitnami

      - name: Install Helm dependencies
        run: helm dependency build .

      - name: Lint Helm chart
        run: helm lint .

      - name: Template Helm chart
        run: helm template .

